<div class="row" [hidden]="showCaseSheet">
  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
    <label class="pull-left">
      <h4 class="f-s-b m-b-10 m-t-20"> Call Auditing </h4>
    </label>
  </div>
  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
    <form #qaForm='ngForm' autocomplete="off">
      <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
          <md2-datepicker name="startDate" (keydown)="blockey($event)"  [(ngModel)]="validFrom" placeholder="Valid From" #startDate="ngModel" ngModel required
        [max]="today"  [style.width]="'100%'"  (change)="setEndDate()"></md2-datepicker>
        <span class="error_text f-s-10 p-l-10" *ngIf="startDate.touched && startDate.errors?.required">Start Date is required</span>
      </div>
      <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
          <md2-datepicker name="endDate" (keydown)="blockey($event)"  [min]="startDate.value" [max]="maxEndDate"  [(ngModel)]="validTill" placeholder="Valid Till" #endDate="ngModel"
          ngModel required [style.width]="'100%'"  (change)="resetValuesOnchange()"></md2-datepicker>
        <span class="error_text f-s-10 p-l-10" *ngIf="endDate.touched && endDate.errors?.required">End Date is required</span>
        <span class="error_text f-s-10 p-l-10" *ngIf="(endDate.value<startDate.value) && endDate.dirty">End Date can not be before Start Date</span>
        <span class="error_text f-s-10 p-l-10" *ngIf="(max<endDate.value) && endDate.dirty">Start Date & End Date can have max 15 days gap</span>
      </div>
      <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 p-b-1-5">
        <!-- <md-input-container class="hide_underline" [style.width]="'100%'">
          <input mdInput style="display:none"> -->
          <md-select placeholder="Service Line" [style.width]="'100%'" [(ngModel)]="serviceID" name="ServiceLine" required>
            <md-option *ngFor="let item of servicelines" [value]="item.serviceID">
              {{item.serviceName}}
            </md-option>
          </md-select>
        <!-- </md-input-container> -->
      </div>
      <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 p-b-1-5">
        <!-- <md-input-container class="hide_underline" [style.width]="'100%'">
          <input mdInput style="display:none"> -->
          <md-select placeholder="Role" [style.width]="'100%'" [(ngModel)]="role" name="Role" (change)="getRoleSpecificAgents(role,roles)">
            <md-option *ngFor="let item of roles" [value]="item.roleName">
              {{item.roleName}}
            </md-option>
          </md-select>
        <!-- </md-input-container> -->
      </div>
      <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 p-b-1-5">
        <!-- <md-input-container class="hide_underline" [style.width]="'100%'">
          <input mdInput style="display:none"> -->
          <md-select placeholder="Inbound/Outbound Call" [style.width]="'100%'" [(ngModel)]="ioc" name="InboundOutbound"  (change)="resetWorklistData()">
            <md-option value="inbound">
              Inbound
            </md-option>
            <md-option value="outbound">
              Outbound
            </md-option>
          </md-select>
        <!-- </md-input-container> -->
      </div>
      <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 p-b-1-5">
        <!-- <md-input-container class="hide_underline" [style.width]="'100%'">
          <input mdInput style="display:none"> -->
          <md-select placeholder="Agent" [style.width]="'100%'" [(ngModel)]="agent" name="Agent">
            <md-option *ngFor="let item of agentIDs" [value]="item.agentID">
              {{item.agentID}}
            </md-option>
          </md-select>
        <!-- </md-input-container> -->
      </div>
      <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3" myMobileNumber>
        <md-input-container [style.width]="'100%'">
          <input mdInput placeholder="Beneficiary Phone Number" [(ngModel)]="phno" minlength="10" maxlength="10" name="benPhoneNo">
        </md-input-container>
      </div>
      <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 p-b-1-5">
        <!-- <md-input-container class="hide_underline" [style.width]="'100%'">
          <input mdInput style="display:none"> -->
          <md-select placeholder="Call Type" [style.width]="'100%'" name="CallType" [(ngModel)]="callGroupType" (change)="populateCallSubTypes(callGroupType)"
            required>
            <md-option *ngFor="let item of callTypes" [value]="item.callGroupType">
              {{item.callGroupType}}
            </md-option>
          </md-select>
        <!-- </md-input-container> -->
      </div>
      <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 p-b-1-5">
        <!-- <md-input-container class="hide_underline" [style.width]="'100%'">
          <input mdInput style="display:none"> -->
          <md-select placeholder="Call SubType" [style.width]="'100%'" [(ngModel)]="callsubtype" [disabled]="callGroupType==='All'"
            name="CallSubType" required>
            <md-option *ngFor="let item of callSubTypes" [value]="item.callTypeID">
              {{item.callType}}
            </md-option>
          </md-select>
        <!-- </md-input-container> -->
      </div>
      <div class="col-xs-3 col-sm-3 col-md-3 col-lg-3">
        <button md-raised-button color="accent" class="m-t-10" (click)="callRecordingRequestFordate(1,qaForm.value);resetFlag()" [disabled]="qaForm.invalid || (endDate.value<startDate.value)">Search</button>
        <button md-raised-button color="primary" class="m-t-10" (click)="reset();resetFlag()">Reset</button>
      </div>
    </form>
  </div>
  <div class="col-xs-12 col-sm-12">

    <div class="table-responsive">
    <table class="table table-hover table-striped" [md2Data]="filteredCallList" #md2="md2DataTable">
      <thead>
        <tr>
          <th>S.No.</th>
          <th>Call ID</th>
          <th>Call Date & Time</th>
          <th>Beneficiary ID</th>
          <th>Beneficiary Name</th>
          <th>Beneficiary Phone No.</th>
          <th>Call Remarks</th>
          <th>Call Type</th>
          <th>Case Sheet</th>
          <th>Voice Record</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngIf="md2.data.length==0">
          <td class="record-not-found" colspan="10">
            No records found
          </td>
        </tr>
        <tr *ngFor="let record of  md2.data;let i=index ">
          <td>{{(md2.activePage-1)*(md2.rowsPerPage)+i+1}}</td>
          <td>{{record.benCallID?record.benCallID:'-'}}</td>
          <td>{{record.callTime| utcDate| date:'dd/MM/yyyy hh:mm a'}}</td>
          <td>{{record.beneficiaryID?record.beneficiaryID:'-'}}</td>
          <td>{{record.name?record.name:'-'}}</td>
          <td>{{record.phoneNo?record.phoneNo:'-'}}</td>
          <td>{{record.remarks?record.remarks:'-'}}</td>
          <td>{{record.callType?record.callType:'-'}}</td>
          <td>
            <i class="fa fa-file-text-o f-s-20 m-t--8 pull-left f-c-g cursorPointer" aria-hidden="true" (click)="invokeCaseSheetDialog(record.benCallID,record)"></i>
          </td>
          <td>
               
            <img *ngIf="!(dispFlag==((md2.activePage-1)*(md2.rowsPerPage)+i+1))" style="width:30px;height:30px" (click)="check(record.agentID,record.callID,(md2.activePage-1)*(md2.rowsPerPage)+i+1)" src="assets/images/playicon.jpg" alt="Play" title="Play">
                              
            <audio  *ngIf="dispFlag==((md2.activePage-1)*(md2.rowsPerPage)+i+1)" controls autoplay preload="none">  
              
              <source src="{{audioResponse}}" type="audio/ogg">
              <source src="{{audioResponse}}" type="audio/mpeg">
                
              </audio>
            
          </td>

        </tr>
      </tbody>
      <!-- <tfoot>
        <tr>
          <td colspan="10">
            <md2-pagination (click)="resetFlag()"></md2-pagination>
          </td>
        </tr>
      </tfoot> -->
      <tfoot *ngIf="md2.data.length > 0">
        <tr>
          <td
            colspan="1"
            class="m-t-5"
            *ngIf="pager?.pages && pager?.pages.length"
          >
            <label>Total Pages:</label>
            {{ pageCount }}
          </td>
          <td colspan="10">
            <ul
              *ngIf="pager?.pages && pager?.pages.length"
              class="pagination pull-right"
            >
              <li [ngClass]="{ disabled: pager.currentPage <= 1 }">
                <a (click)="setPage(1, qaForm.value)"> << </a>
              </li>
              <li [ngClass]="{ disabled: pager.currentPage <= 1 }">
                <a (click)="setPage(pager.currentPage - 1, qaForm.value)">
                  <
                </a>
              </li>
              <li
                *ngFor="let page of pager.pages"
                [ngClass]="{ active: pager.currentPage === page }"
              >
                <a (click)="setPage(page, qaForm.value)">{{ page }}</a>
              </li>
              <li
                [ngClass]="{ disabled: pager.currentPage >= pager.totalPages }"
              >
                <a (click)="setPage(pager.currentPage + 1, qaForm.value)">></a>
              </li>
              <li
                [ngClass]="{ disabled: pager.currentPage >= pager.totalPages }"
              >
                <a (click)="setPage(pager.totalPages, qaForm.value)">>></a>
              </li>
            </ul>
          </td>
        </tr>
      </tfoot>

    </table>
  </div>
  </div>
</div>
<div class="row p-r-30" [hidden]="!showCaseSheet">
    <div class="col-xs-12 col-sm-12">
      <h4 class="pull-left">Case Sheet</h4>
      <button md-raised-button color="primary" class="m-t-5 pull-right noprint" (click)="hideCaseSheetFunction()"><span class="noprint">Back</span></button>
    </div>
    <div class="col-xs-12 col-sm-12 "> 
      <h4 class="col-xs-12 col-sm-12 m-t-10 ">Service Type 1097
        <ul class="pull-right list-inline list-unstyled noprint"> 
           <li class="f-s-14 noprint"><a class="noprint" (click)="print()"><i class="fa fa-download cursorPointer noprint" aria-hidden="true"></i>Download</a></li>  
          <li class="f-s-14">
            <strong> Date :</strong>
            <span> {{current_date|date:'dd/MM/yyyy'}}</span>
          </li>
        </ul>
      </h4>
      <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3 m-t-10 "> </div>
    </div> 
    <div class="col-xs-12 col-sm-12 border-a-1 m-b-20 m-l-15">
      <h4 class="m-t--15">
        <span class="caseSheetHeader">Beneficiary Details</span>
      </h4>
      <div class="table-responsive">
        <table class="table printTable m-b-0">
          <tr>
            <td class="col-xs-12 col-sm-3 p-l-0">
              <strong> Call ID :</strong>
            </td>
            <td class="col-xs-12 col-sm-3">{{benData?.benCallID}}</td>
            <td class="col-xs-12 col-sm-3 p-l-0">
              <strong>Agent ID :</strong>
            </td>
            <td class="col-xs-12 col-sm-3">{{benData?.agentID}}</td>
          </tr>
          <tr>
            <td class="col-xs-12 col-sm-3 p-l-0">
              <strong> First Name :</strong>
            </td>
            <td class="col-xs-12 col-sm-3">{{benData?.beneficiaryModel?.firstName}}</td>
            <td class="col-xs-12 col-sm-3 p-l-0">
              <strong>Last Name :</strong>
            </td>
            <td class="col-xs-12 col-sm-3">{{benData?.beneficiaryModel?.lastName}}</td>
          </tr>
          <tr>
            <td class="col-xs-12 col-sm-3 p-l-0">
              <strong> Age :</strong>
            </td>
            <td class="col-xs-12 col-sm-3">{{benData?.beneficiaryModel?.actualAge}} {{benData?.beneficiaryModel?.ageUnits}}</td>
            <td class="col-xs-12 col-sm-3 p-l-0">
              <strong> Gender :</strong>
            </td>
            <td class="col-xs-12 col-sm-3">{{benData?.beneficiaryModel?.m_gender?.genderName}}</td>
          </tr>
          <tr>
            <td class="col-xs-12 col-sm-3 p-l-0">
              <strong> Address :</strong>
            </td>
            <td class="col-xs-12 col-sm-3">{{benData?.beneficiaryModel?.i_bendemographics?.districtBranchName?benData?.beneficiaryModel?.i_bendemographics?.districtBranchName:'-'}},
              {{benData?.beneficiaryModel?.i_bendemographics?.blockName?benData?.beneficiaryModel?.i_bendemographics?.blockName:'-'}},
              {{benData?.beneficiaryModel?.i_bendemographics?.districtName?benData?.beneficiaryModel?.i_bendemographics?.districtName:'-'}},
              {{benData?.beneficiaryModel?.i_bendemographics?.stateName?benData?.beneficiaryModel?.i_bendemographics?.stateName:'-'}}
              - {{benData?.beneficiaryModel?.i_bendemographics?.pinCode?benData?.beneficiaryModel?.i_bendemographics?.pinCode:'-'}}
              | India</td>
            <td class="col-xs-12 col-sm-3 p-l-0">
              <strong> Beneficiary ID :</strong>
            </td>
            <td class="col-xs-12 col-sm-3">{{benData?.beneficiaryModel?.beneficiaryID}}</td>
          </tr>
          
        </table>
      </div>
    </div>
    <div class="col-xs-12 col-sm-12 border-a-1 m-b-20 m-l-15 m-b-40 p-l-12 p-r-46">
      <h4 class="m-t--15">
        <span class="caseSheetHeader">Service Requested</span>
      </h4>
      <div class="col-xs-12 col-sm-12 border-a-1 m-b-10">
        <h4 class="">
          <span class="">Information Service</span>
        </h4>
        <div class="table-responsive">
          <table class="table printTable m-b-0">
            <tbody *ngFor="let item of information_services">
              <tr>
                <td class="col-xs-12 col-sm-3 p-l-0">
                  <strong> Category :</strong>
                </td>
                <td class="col-xs-12 col-sm-3">{{item?.categoryDetails?.categoryName}}</td>
                <td class="col-xs-12 col-sm-3 p-l-0">
                  <strong>Sub Category :</strong>
                </td>
                <td class="col-xs-12 col-sm-3">{{item?.subCategoryName}}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="col-xs-12 col-sm-12 border-a-1 m-b-10">
        <h4 class="">
          <span class="">Counselling Service</span>
        </h4>
        <div class="table-responsive">
          <table class="table printTable m-b-0">
            <tbody *ngFor="let item of counselling_services">
              <tr>
                <td class="col-xs-12 col-sm-3 p-l-0">
                  <strong> Category :</strong>
                </td>
                <td class="col-xs-12 col-sm-3">{{item?.categoryDetails?.categoryName}}</td>
                <td class="col-xs-12 col-sm-3 p-l-0">
                  <strong>Sub Category :</strong>
                </td>
                <td class="col-xs-12 col-sm-3">{{item?.subCategoryName}}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="col-xs-12 col-sm-12 border-a-1 m-b-10">
        <h4 class="">
          <span class="">Feedback Service</span>
        </h4>
        <div class="table-responsive">
          <table class="table printTable m-b-0">
            <tbody *ngFor="let item of feedback_services">
              <tr>
                <td class="col-xs-12 col-sm-3 p-l-0">
                  <strong>State:</strong>
                </td>
                <td class="col-xs-12 col-sm-3">{{item?.states?.stateName}}</td>
                <td class="col-xs-12 col-sm-3 p-l-0">
                  <strong>District :</strong>
                </td>
                <td class="col-xs-12 col-sm-3">{{item?.district?.districtName}}</td>
              </tr>
              <tr>
                <td class="col-xs-12 col-sm-3 p-l-0">
                  <strong>Sub District :</strong>
                </td>
                <td class="col-xs-12 col-sm-3">{{item?.districtBlock?.blockName}}</td>
                <td class="col-xs-12 col-sm-3 p-l-0">
                  <strong>Institute Name:</strong>
                </td>
                <td class="col-xs-12 col-sm-3">-</td>
              </tr>
              <tr>
                <td class="col-xs-12 col-sm-3 p-l-0">
                  <strong>Designation :</strong>
                </td>
                <td class="col-xs-12 col-sm-3">{{item?.designation?.designationName}}</td>
                <td class="col-xs-12 col-sm-3 p-l-0">
                  <strong>Type of Feedback:</strong>
                </td>
                <td class="col-xs-12 col-sm-3">{{item?.FeedbackTypeID?.feedbackTypeName}}</td>
              </tr>
              <tr>
                <td class="col-xs-12 col-sm-3 p-l-0">
                  <strong>Incident date :</strong>
                </td>
                <td class="col-xs-12 col-sm-3">{{item?.serviceAvailDate|utcDate|date:'dd/MM/yyyy'}}</td>
                <td class="col-xs-12 col-sm-3 p-l-0">
                  <strong>Severity:</strong>
                </td>
                <td class="col-xs-12 col-sm-3">{{item?.severity?.severityTypeName}}</td>
              </tr>
              <tr>
                <td class="col-xs-12 col-sm-3 p-l-0">
                  <strong>Feedback Description:</strong>
                </td>
                <td class="col-xs-12 col-sm-3">{{item?.feedback}}</td>
                <td class="col-xs-12 col-sm-3 p-l-0">
                  <strong>Feedback ID:</strong>
                </td>
                <td class="col-xs-12 col-sm-3">{{item?.feedbackID}}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="col-xs-12 col-sm-12 border-a-1 m-b-10">
        <h4 class="">
          <span class="">Referral Service</span>
        </h4>
        <div class="table-responsive">
          <table class="table printTable m-b-0">
            <tbody *ngFor="let item of refferal_services">
              <tr>
                <td class="col-xs-12 col-sm-3 p-l-0">
                  <strong>State:</strong>
                </td>
                <td class="col-xs-12 col-sm-3">{{item.institutionDetails.states.stateName}}</td>
                <td class="col-xs-12 col-sm-3 p-l-0">
                  <strong>District :</strong>
                </td>
                <td class="col-xs-12 col-sm-3">{{item.institutionDetails.m_district.districtName}}</td>
              </tr>
              <tr>
                <td class="col-xs-12 col-sm-3 p-l-0">
                  <strong>Sub District :</strong>
                </td>
                <td class="col-xs-12 col-sm-3">{{item.institutionDetails.block.blockName}}</td>
                <td class="col-xs-12 col-sm-3 p-l-0">
                  <strong>Information Required:</strong>
                </td>
                <td class="col-xs-12 col-sm-3">{{item.directory.instituteDirectoryName}},{{item.subDirectory.instituteSubDirectoryName}}</td>
              </tr>
              <tr>
                <td class="col-xs-12 col-sm-3 p-l-0">
                  <strong> Results :</strong>
                </td>
                <td class="col-xs-12 col-sm-3">{{item.institutionDetails.institutionName}},{{item.institutionDetails.address}}</td>
                <td class="col-xs-12 col-sm-3 p-l-0">
                  <strong> </strong>
                </td>
                <td class="col-xs-12 col-sm-3"></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
      
</div>

<!--Below line commented on 21 may,2018 for screen revamp, Diamond Khanna  -->
<!-- <iframe [src]="qualityAuditURL" width="100%" height="700px"></iframe> -->